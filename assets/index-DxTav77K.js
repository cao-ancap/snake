(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function o(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=o(n);fetch(n.href,i)}})();var a=(e=>(e[e.Slug=0]="Slug",e[e.Rat=1]="Rat",e[e.Frog=2]="Frog",e))(a||{}),u=(e=>(e[e.Up=0]="Up",e[e.Right=1]="Right",e[e.Down=2]="Down",e[e.Left=3]="Left",e))(u||{});const l=21,S=3,h={x:0,y:-1},p={x:1,y:0},y={x:0,y:1},w={x:-1,y:0},F=()=>({x:Math.floor(Math.random()*l),y:Math.floor(Math.random()*l)}),v=()=>[h,p,y,w][Math.floor(Math.random()*4)],N=e=>e===a.Slug?a.Slug:[a.Slug,a.Rat,a.Frog][Math.floor(Math.random()*(e+1))],M=e=>({position:F(),direction:v(),type:N(e)}),A=e=>e&&Math.random()>.8?{position:v()}:null,B=()=>{const e=Math.floor(l/2);return{snake:{positions:Array.from({length:S},(t,o)=>({x:S-o-1,y:e})),direction:p},food:M(a.Slug),trap:null,gameOver:!1,gameRunning:!0}};let s=B();const U=()=>{const e=document.getElementById("board");for(let t=0;t<l*l;t+=1){const o=document.createElement("div");o.classList.add("cell"),e.appendChild(o)}return e},W=document.getElementById("score"),k=()=>s.snake.positions.length-S,x=()=>{W.innerHTML=String(k())},m=e=>e.y*l+e.x,E=e=>{const t=e.querySelectorAll(".cell"),[o,...r]=s.snake.positions,n=m(o),i=r.map(m),c=m(s.food.position),f=s.trap!==null?m(s.trap.position):null;t.forEach((P,g)=>{const d=[];if(d.push("cell"),n===g)d.push("snake");else if(i.includes(g))d.push("tail");else if(c===g)switch(d.push("food"),s.food.type){case a.Slug:d.push("slug");break;case a.Rat:d.push("rat");break;case a.Frog:d.push("frog");break}else f===g&&d.push("trap");P.className=d.join(" ")})},L=(e,t)=>e.x===t.x&&e.y===t.y,I=(e,t,o=1)=>{const r={x:e.x+t.x*o,y:e.y+t.y*o};return r.x=(r.x+l)%l,r.y=(r.y+l)%l,r},G=e=>{const t={...e},o=I(e.positions[0],e.direction);return t.positions=[o,...e.positions.slice(0,-1)],t},T=e=>{let t=!1,o=1;switch(e.type){case a.Slug:t=Math.random()>.98;break;case a.Rat:t=Math.random()>.8;break;case a.Frog:t=Math.random()>.94,o=2;break}if(t){const r=I(e.position,e.direction,o);return{...e,position:r}}return e},q=(e,t)=>{const[o,...r]=e.positions;return t!==null&&L(o,t.position)?!0:r.some(n=>L(n,o))},O=e=>{if(s.gameOver){alert("Game over!");return}const t=G(s.snake);q(t,s.trap)&&(s.gameOver=!0);let o=s.food,r=s.trap;const n=L(t.positions[0],s.food.position);if(n){t.positions.push({...s.snake.positions[t.positions.length-1]});let c=a.Slug;const f=k();switch(Math.floor(f/5)){case 0:c=a.Slug;break;case 1:c=a.Rat;break;default:c=a.Frog}o=M(c),r=A(f>7)}else o=T(s.food);s={...s,snake:t,food:o,trap:r},n&&x(),E(e),setTimeout(()=>O(e),200)},C={ARROWUP:h,ARROWRIGHT:p,ARROWDOWN:y,ARROWLEFT:w,W:h,D:p,S:y,A:w},H=e=>{const t=C[e.key.toLocaleUpperCase()];t!==void 0&&(s.snake.direction=t)},K={[u.Up]:h,[u.Right]:p,[u.Down]:y,[u.Left]:w},R=e=>{const t=K[e];t!==void 0&&(s.snake.direction=t)},b=U();document.addEventListener("keydown",H);document.getElementById("up").addEventListener("mousedown",()=>R(u.Up));document.getElementById("right").addEventListener("mousedown",()=>R(u.Right));document.getElementById("down").addEventListener("mousedown",()=>R(u.Down));document.getElementById("left").addEventListener("mousedown",()=>R(u.Left));x();E(b);O(b);
