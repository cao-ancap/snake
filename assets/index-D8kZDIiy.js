(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function o(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=o(n);fetch(n.href,i)}})();var u=(e=>(e.Food="food",e.Trap="trap",e.SnakeHead="head",e.SnakeTail="tail",e))(u||{}),a=(e=>(e[e.Slug=0]="Slug",e[e.Rat=1]="Rat",e[e.Frog=2]="Frog",e))(a||{}),p=(e=>(e[e.Up=0]="Up",e[e.Right=1]="Right",e[e.Down=2]="Down",e[e.Left=3]="Left",e))(p||{});const d=21,L=3,y={x:0,y:-1},m={x:1,y:0},S={x:0,y:1},k={x:-1,y:0},N=()=>({x:Math.floor(Math.random()*d),y:Math.floor(Math.random()*d)}),x=()=>[y,m,S,k][Math.floor(Math.random()*4)],B=e=>e===a.Slug?a.Slug:[a.Slug,a.Rat,a.Frog][Math.floor(Math.random()*(e+1))],M=e=>({position:N(),direction:x(),type:B(e)}),T=e=>e&&Math.random()>.8?{position:x()}:null,U=()=>{const e=Math.floor(d/2);return{snake:{positions:Array.from({length:L},(t,o)=>({x:L-o-1,y:e})),direction:m},food:M(a.Slug),trap:null,gameOver:!1,gameRunning:!0}};let s=U();const W=()=>{const e=document.getElementById("board");for(let t=0;t<d*d;t+=1){const o=document.createElement("div");o.classList.add("cell"),e.appendChild(o)}return e},H=document.getElementById("score"),b=()=>s.snake.positions.length-L,E=()=>{H.innerHTML=String(b())},h=e=>e.y*d+e.x,I=e=>{const t=e.querySelectorAll(".cell"),[o,...r]=s.snake.positions,n=h(o),i=r.map(h),c=h(s.food.position),f=s.trap!==null?h(s.trap.position):null,g=Array(t.length);f!==null&&(g[f]=u.Trap),g[c]=u.Food,g[n]=u.SnakeHead,i.forEach(R=>g[R]=u.SnakeTail),t.forEach((R,A)=>{const l=[];switch(l.push("cell"),g[A]){case u.Trap:l.push("trap");break;case u.Food:switch(l.push("food"),s.food.type){case a.Slug:l.push("slug");break;case a.Rat:l.push("rat");break;case a.Frog:l.push("frog");break}break;case u.SnakeHead:l.push("snake");break;case u.SnakeTail:l.push("tail");break}R.className=l.join(" ")})},v=(e,t)=>e.x===t.x&&e.y===t.y,O=(e,t,o=1)=>{const r={x:e.x+t.x*o,y:e.y+t.y*o};return r.x=(r.x+d)%d,r.y=(r.y+d)%d,r},G=e=>{const t={...e},o=O(e.positions[0],e.direction);return t.positions=[o,...e.positions.slice(0,-1)],t},q=e=>{let t=!1,o=1;switch(e.type){case a.Slug:t=Math.random()>.98;break;case a.Rat:t=Math.random()>.8;break;case a.Frog:t=Math.random()>.94,o=2;break}if(t){const r=O(e.position,e.direction,o);return{...e,position:r}}return e},C=(e,t)=>{const[o,...r]=e.positions;return t!==null&&v(o,t.position)?!0:r.some(n=>v(n,o))},P=e=>{if(s.gameOver){alert("Game over!");return}const t=G(s.snake);C(t,s.trap)&&(s.gameOver=!0);let o=s.food,r=s.trap;const n=v(t.positions[0],s.food.position);if(n){t.positions.push({...s.snake.positions[t.positions.length-1]});let c=a.Slug;const f=b();switch(Math.floor(f/5)){case 0:c=a.Slug;break;case 1:c=a.Rat;break;default:c=a.Frog}o=M(c),r=T(f>7)}else o=q(s.food);s={...s,snake:t,food:o,trap:r},n&&E(),I(e),setTimeout(()=>P(e),200)},K={ARROWUP:y,ARROWRIGHT:m,ARROWDOWN:S,ARROWLEFT:k,W:y,D:m,S,A:k},z=e=>{const t=K[e.key.toLocaleUpperCase()];t!==void 0&&(s.snake.direction=t)},D={[p.Up]:y,[p.Right]:m,[p.Down]:S,[p.Left]:k},w=e=>{const t=D[e];t!==void 0&&(s.snake.direction=t)},F=W();document.addEventListener("keydown",z);document.getElementById("up").addEventListener("mousedown",()=>w(p.Up));document.getElementById("right").addEventListener("mousedown",()=>w(p.Right));document.getElementById("down").addEventListener("mousedown",()=>w(p.Down));document.getElementById("left").addEventListener("mousedown",()=>w(p.Left));E();I(F);P(F);
